<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FS ‚Ä¢ –ß–∏—Å—Ç–∞—è –≤–æ–¥–∞ –±—É–¥—É—â–µ–≥–æ</title>
  <style>
    :root{
      --ink:#0a1f33; --text:#32475c; --blue:#2b8cff; --blue-dark:#1047a8;
      --panel:#ffffff; --shadow-big:0 25px 80px rgba(0,0,0,.12); --page-x:8vw;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--ink); background:#fff; overflow-x:hidden;
    }

    /* HEADER (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) */
    .topbar{position:sticky;top:0;z-index:20;display:flex;align-items:center;justify-content:space-between;padding:18px var(--page-x);background:#fff;border-bottom:1px solid rgba(0,0,0,.06)}
    .logo{font-family:Impact,Haettenschweiler,'Arial Black',sans-serif;font-size:44px}
    nav a{text-decoration:none;color:var(--ink);margin-left:28px;font-weight:600;transition:opacity .2s}
    nav a:hover{opacity:.75}

    /* HERO */
    .hero{background:var(--blue);color:#fff;min-height:72vh;display:grid;place-items:center;gap:28px;padding:72px 0 96px}
    .capsule{position:relative;background:var(--panel);border-radius:999px;width:min(1000px,85vw);height:min(460px,58vh);display:flex;align-items:center;justify-content:center;box-shadow:var(--shadow-big)}
    .capsule::after{/* –º—è–≥–∫–∏–π –±–ª–∏–∫, –µ–¥–≤–∞ –∑–∞–º–µ—Ç–Ω—ã–π */content:"";position:absolute;inset:0;border-radius:inherit;background:linear-gradient(100deg,rgba(255,255,255,0) 0%,rgba(255,255,255,.22) 50%,rgba(255,255,255,0) 100%);transform:translateX(-100%);animation:shine 7s linear infinite}
    @keyframes shine{to{transform:translateX(100%)}}

    .odo{display:flex;gap:8px}
    .digit{
      position:relative; overflow:hidden; border-radius:12px;
      width:clamp(56px,7vw,96px); height:clamp(98px,15vw,170px);
      background:transparent;
    }
    .strip{position:absolute; inset:0; display:flex; flex-direction:column; will-change:transform}
    .cell{
      height:100%; display:flex; align-items:center; justify-content:center;
      font-family:Impact,Haettenschweiler,'Arial Black',sans-serif;
      font-size:clamp(68px,13vw,160px); color:var(--ink);
    }
    /* FIX: –±–æ–ª–µ–µ –ø–ª–∞–≤–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ + –∫–∞—Å–∫–∞–¥–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ */
    .digit.anim .strip{transition:transform .5s cubic-bezier(.22,.8,.18,1)}
    .digit[data-i="0"].anim .strip{transition-delay:.00s}
    .digit[data-i="1"].anim .strip{transition-delay:.02s}
    .digit[data-i="2"].anim .strip{transition-delay:.04s}
    .digit[data-i="3"].anim .strip{transition-delay:.06s}
    .digit[data-i="4"].anim .strip{transition-delay:.08s}
    .digit[data-i="5"].anim .strip{transition-delay:.10s}

    .subtitle{max-width:980px;text-align:center;color:#fff;font-family:Impact,Haettenschweiler,'Arial Black',sans-serif;font-size:clamp(20px,2.4vw,30px);line-height:1.35}

    /* REVEAL (–¥–æ–±–∞–≤–ª–µ–Ω–æ) */
    .reveal{opacity:0; transform:translateY(30px); transition:opacity .8s ease, transform .8s ease}
    .reveal.visible{opacity:1; transform:translateY(0)}

    /* WHY */
    .why{position:relative; overflow:hidden; padding:120px var(--page-x) 140px; background:#fff}
    .why h2{position:relative; z-index:2; font-family:Impact,Haettenschweiler,'Arial Black',sans-serif; font-size:clamp(40px,5.2vw,76px); margin-bottom:14px}
    .why p{position:relative; z-index:2; color:var(--text); max-width:980px; line-height:1.65; font-size:clamp(18px,2vw,22px)}
    #bottleCanvas{position:absolute; inset:0; z-index:0; pointer-events:none} /* —Å—Ç—Ä–æ–≥–æ –∑–∞ —Ç–µ–∫—Å—Ç–æ–º */

    /* PRODUCTS (–æ—Å—Ç–∞–≤–∏–ª –∫–∞–∫ –µ—Å—Ç—å) */
    .products{padding:120px var(--page-x); text-align:center; background:#fff}
    .products h2{font-family:Impact,Haettenschweiler,'Arial Black',sans-serif; font-size:clamp(36px,5vw,72px)}
    .subtitle-small{color:var(--text); font-size:clamp(18px,2vw,22px); margin:8px 0 60px}
    .cards-wrapper{display:grid; grid-template-columns:repeat(2,minmax(280px,1fr)); gap:40px; max-width:1000px; margin:0 auto}
    .card{background:linear-gradient(180deg,#f8fbff 0%,#e8f1ff 100%); border-radius:28px; padding:40px 32px; box-shadow:0 10px 30px rgba(0,0,0,.05); transition:transform .3s ease, box-shadow .3s ease; text-align:left}
    .card:hover{transform:translateY(-6px); box-shadow:0 16px 40px rgba(43,140,255,.18)}
    .card-icon{font-size:38px; margin-bottom:18px}
    .card h3{font-family:Impact,Haettenschweiler,'Arial Black',sans-serif; font-size:22px; color:var(--ink); margin-bottom:10px}
    .card p{font-size:17px; color:var(--text); line-height:1.5}
    @media (max-width: 768px){
      .cards-wrapper{display:flex; overflow-x:auto; scroll-snap-type:x mandatory; gap:24px; padding-bottom:10px; -webkit-overflow-scrolling:touch}
      .card{flex:0 0 85%; scroll-snap-align:center; text-align:center; padding:32px}
    }

    /* TECH (—Ç–æ–ª—å–∫–æ —Ü–≤–µ—Ç –∏ –ø–æ—Ç–æ–∫ –ø–æ–ø—Ä–∞–≤–∏–ª) */
    .tech{position:relative; overflow:hidden; padding:120px var(--page-x) 140px; background:#fff}
    .tech h2{font-family:Impact,Haettenschweiler,'Arial Black',sans-serif; font-size:clamp(40px,5.2vw,76px); margin-bottom:12px}
    .lead{color:var(--text); max-width:900px; line-height:1.65; font-size:clamp(18px,2vw,22px); margin-bottom:24px}
    .pipe-wrap{position:relative}
    .pipe-svg{width:100%; filter:drop-shadow(0 12px 28px rgba(16,71,168,.12))}
    /* FIX: –º—è–≥–∫–∏–π LTR-—Ü–∏–∫–ª (–¥–ª–∏–Ω–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ 520 = 90+430) */
    @keyframes flowLeftToRight{from{stroke-dashoffset:520} to{stroke-dashoffset:0}}
    #flow{animation:flowLeftToRight 5s linear infinite}

    .stage-dot{
      position:absolute; left:var(--x); top:var(--y); transform:translate(-50%,-50%);
      width:26px; height:26px; border-radius:50%;
      background:var(--blue); border:3px solid #fff;
      box-shadow:0 0 12px rgba(43,140,255,.6);
      cursor:pointer; z-index:3;
      animation:pulse 1.8s ease-in-out infinite;
    }
    .stage-dot.active{background:#0f56cf}
    @keyframes pulse{
      0%,100%{box-shadow:0 0 10px rgba(43,140,255,.6), 0 0 0 0 rgba(43,140,255,.35)}
      50%{box-shadow:0 0 18px rgba(43,140,255,.9), 0 0 0 10px rgba(43,140,255,0)}
    }

    .stage-info{
      position:absolute; left:50%; top:50%; transform:translate(-50%,-130%);
      min-width:240px; max-width:320px; padding:12px 14px;
      background:rgba(11,31,51,.95); color:#fff; border-radius:12px;
      box-shadow:0 12px 28px rgba(0,0,0,.25); z-index:4;
    }
    .stage-info h3{font-family:Impact,Haettenschweiler,'Arial Black',sans-serif; font-size:18px; margin-bottom:6px}
    .stage-info p{font-size:13px; line-height:1.5; color:#e7eef8}
  </style>
</head>
<body>
  <header class="topbar">
    <div class="logo">FS</div>
    <nav>
      <a href="#about">–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ</a>
      <a href="#tech">–ö–∞–∫ –æ—á–∏—â–∞–µ–º –≤–æ–¥—É</a>
    </nav>
  </header>

  <main>
    <!-- HERO -->
    <section class="hero" id="hero">
      <div class="capsule">
        <div id="odo" class="odo" aria-live="polite"></div>
      </div>
      <h1 class="subtitle reveal">–ò–º–µ–Ω–Ω–æ —Å—Ç–æ–ª—å–∫–æ —Ç—ã—Å—è—á –ø–ª–∞—Å—Ç–∏–∫–æ–≤—ã—Ö –±—É—Ç—ã–ª–æ–∫ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –≤ –†–æ—Å—Å–∏–∏, –ø–æ–∫–∞ –≤—ã –∑–¥–µ—Å—å</h1>
    </section>

    <!-- –ü–û–ß–ï–ú–£ –≠–¢–û –í–ê–ñ–ù–û -->
    <section class="why" id="about" aria-labelledby="why-title">
      <canvas id="bottleCanvas" aria-hidden="true"></canvas>
      <h2 id="why-title" class="reveal">–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ</h2>
      <p class="reveal">
        –ö–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É ‚Äî —Ç—ã—Å—è—á–∏ –ø–ª–∞—Å—Ç–∏–∫–æ–≤—ã—Ö –±—É—Ç—ã–ª–æ–∫, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å—á–µ–∑–Ω—É—Ç.
        FS —Å–æ–∑–¥–∞—ë—Ç —Å–∏—Å—Ç–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ—á–∏—â–∞—é—Ç –≤–æ–¥—É –∏ —É–º–µ–Ω—å—à–∞—é—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç—Ö–æ–¥–æ–≤,
        –≤–æ–∑–≤—Ä–∞—â–∞—è –ø—Ä–∏—Ä–æ–¥–µ —Ç–æ, —á—Ç–æ –µ–π –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç.
      </p>
    </section>

    <!-- –ß–¢–û –î–ï–õ–ê–ï–¢ FS (–±–µ–∑ –ø—Ä–∞–≤–æ–∫) -->
    <section class="products" id="products">
      <h2 class="reveal">–ß—Ç–æ –¥–µ–ª–∞–µ—Ç FS</h2>
      <p class="subtitle-small reveal">–°–∏—Å—Ç–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ—á–∏—â–∞—é—Ç –≤–æ–¥—É ‚Äî –∏ –∑–∞–±–æ—Ç—è—Ç—Å—è –æ –±—É–¥—É—â–µ–º.</p>
      <div class="cards-wrapper">
        <div class="card reveal"><div class="card-icon">üè†</div><h3>–§–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã<br>–¥–ª—è —á–∞—Å—Ç–Ω—ã—Ö –¥–æ–º–æ–≤</h3><p>–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –¥–ª—è –∞–≤—Ç–æ–Ω–æ–º–Ω—ã—Ö –¥–æ–º–æ–≤ –∏ –∫–æ—Ç—Ç–µ–¥–∂–µ–π.</p></div>
        <div class="card reveal"><div class="card-icon">üèóÔ∏è</div><h3>–°–∏—Å—Ç–µ–º—ã –≤–æ–¥–æ–æ—á–∏—Å—Ç–∫–∏<br>–¥–ª—è –¥–µ–≤–µ–ª–æ–ø–µ—Ä–æ–≤</h3><p>–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –ø–æ–¥ –ø—Ä–æ–µ–∫—Ç—ã –ª—é–±–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∞ ‚Äî –æ—Ç –∂–∏–ª—ã—Ö –∫–≤–∞—Ä—Ç–∞–ª–æ–≤ –¥–æ –±–∏–∑–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä–æ–≤.</p></div>
        <div class="card reveal"><div class="card-icon">üè¢</div><h3>–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è<br>–¥–ª—è –∫–≤–∞—Ä—Ç–∏—Ä</h3><p>–§–∏–ª—å—Ç—Ä—ã —Å –∞–¥–∞–ø—Ç–∞—Ü–∏–µ–π –ø–æ–¥ —Ç–∏–ø –≤–æ–¥–æ—Å–Ω–∞–±–∂–µ–Ω–∏—è, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –≤–æ–¥—ã.</p></div>
        <div class="card reveal"><div class="card-icon">üîß</div><h3>–°–µ—Ä–≤–∏—Å –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ</h3><p>–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–º–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤.</p></div>
      </div>
    </section>

    <!-- –ö–ê–ö –û–ß–ò–©–ê–ï–ú –í–û–î–£ -->
    <section class="tech" id="tech" aria-labelledby="tech-title">
      <h2 id="tech-title" class="reveal">–ö–∞–∫ –º—ã –æ—á–∏—â–∞–µ–º –≤–æ–¥—É</h2>
      <p class="lead reveal">–ü–æ—Ç–æ–∫ –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ç—ã—Ä–µ —Å—Ç–∞–¥–∏–∏: <b>–≥—Ä—É–±–∞—è</b> ‚Üí <b>—Å–æ—Ä–±—Ü–∏—è</b> ‚Üí <b>–º–µ–º–±—Ä–∞–Ω–∞</b> ‚Üí <b>–£–§</b>. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –ø—É–ª—å—Å–∏—Ä—É—é—â–∏–µ —Ç–æ—á–∫–∏.</p>

      <div class="pipe-wrap">
        <svg class="pipe-svg reveal" viewBox="0 0 1200 220" preserveAspectRatio="xMidYMid meet">
          <defs>
            <linearGradient id="tubeGrad" x1="0" x2="1" y1="0" y2="0">
              <stop offset="0" stop-color="#eaf1ff"/>
              <stop offset="1" stop-color="#dbe7ff"/>
            </linearGradient>
            <!-- FIX: —Ç—ë–º–Ω—ã–π —Å–ª–µ–≤–∞ -> —Å–≤–µ—Ç–ª—ã–π —Å–ø—Ä–∞–≤–∞ -->
            <linearGradient id="waterGrad" x1="0" x2="1" y1="0" y2="0">
              <stop offset="0" stop-color="#1047a8"/>
              <stop offset="1" stop-color="#2b8cff"/>
            </linearGradient>
          </defs>

          <!-- —Ç—Ä—É–±–∞ -->
          <path d="M 40 110 H 360
                   C 410 110, 410 40, 460 40
                   H 600
                   C 650 40, 650 180, 700 180
                   H 860
                   C 910 180, 910 110, 960 110
                   H 1160"
                fill="none" stroke="url(#tubeGrad)" stroke-width="36"
                stroke-linecap="round" stroke-linejoin="round" />

          <!-- –ø–æ—Ç–æ–∫ -->
          <path id="flow"
                d="M 40 110 H 360
                   C 410 110, 410 40, 460 40
                   H 600
                   C 650 40, 650 180, 700 180
                   H 860
                   C 910 180, 910 110, 960 110
                   H 1160"
                fill="none" stroke="url(#waterGrad)" stroke-width="16"
                stroke-dasharray="90 430" stroke-linecap="round" stroke-linejoin="round" />
        </svg>

        <!-- —Ç–æ—á–∫–∏ -->
        <button class="stage-dot" style="--x:28%;--y:50%;" data-title="–ì—Ä—É–±–∞—è –æ—á–∏—Å—Ç–∫–∞" data-text="–£–¥–∞–ª—è–µ—Ç –ø–µ—Å–æ–∫ –∏ —Ä–∂–∞–≤—á–∏–Ω—É."></button>
        <button class="stage-dot" style="--x:50%;--y:20%;" data-title="–°–æ—Ä–±—Ü–∏—è" data-text="–£–≥–æ–ª—å —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –∑–∞–ø–∞—Ö –∏ —Ö–ª–æ—Ä."></button>
        <button class="stage-dot" style="--x:67%;--y:83%;" data-title="–ú–µ–º–±—Ä–∞–Ω–∞" data-text="–£–¥–∞–ª—è–µ—Ç —Å–æ–ª–∏ –∏ –±–∞–∫—Ç–µ—Ä–∏–∏."></button>
        <button class="stage-dot" style="--x:88%;--y:51%;" data-title="–£–§" data-text="–û–±–µ–∑–∑–∞—Ä–∞–∂–∏–≤–∞–Ω–∏–µ —É–ª—å—Ç—Ä–∞—Ñ–∏–æ–ª–µ—Ç–æ–º."></button>

        <div class="stage-info" id="stageInfo" hidden>
          <h3 id="stageTitle"></h3>
          <p id="stageText"></p>
        </div>
      </div>
    </section>
  </main>

  <script>
  // –°—Ç–∞—Ä—Ç –≤—Å–µ–≥–¥–∞ —Å HERO (–µ—Å–ª–∏ –Ω–µ—Ç —Ö—ç—à–∞)
  (function(){ if('scrollRestoration' in history) history.scrollRestoration='manual'; if(!location.hash) window.scrollTo(0,0); })();

  // FIX 1: –°–ß–Å–¢–ß–ò–ö ‚Äî –ª–∏—Å—Ç–∞–µ—Ç—Å—è –°–í–ï–†–•–£ –í–ù–ò–ó, –ø–ª–∞–≤–Ω–µ–µ, 6000 –±—É—Ç/—Å–µ–∫ ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç—ã—Å—è—á–∏ (+6/—Å)
  (function(){
    const BOTTLES_PER_SEC=6000;   // —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    const DIGITS=6;               // 6 —è—á–µ–µ–∫, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç—ã—Å—è—á–∏
    const STEP_THOUSANDS=0.1;     // —à–∞–≥ –¥–ª—è –ø–ª–∞–≤–Ω–æ—Å—Ç–∏
    const odo=document.getElementById('odo');

    // —Å–æ–∑–¥–∞—ë–º —Å—Ç–æ–ª–±—Ü—ã —Å —Ü–∏—Ñ—Ä–∞–º–∏ –≤ –û–ë–†–ê–¢–ù–û–ú –ø–æ—Ä—è–¥–∫–µ: 9..0(+9) ‚Üí —á—Ç–æ–±—ã –¥–≤–∏–∂–µ–Ω–∏–µ –±—ã–ª–æ –≤–∏–∑—É–∞–ª—å–Ω–æ –≤–Ω–∏–∑
    function makeDigit(i){
      const d=document.createElement('div'); d.className='digit'; d.dataset.i=i;
      const s=document.createElement('div'); s.className='strip';
      for(let k=9;k>=0;k--){ const c=document.createElement('div'); c.className='cell'; c.textContent=k; s.appendChild(c); }
      const extra=document.createElement('div'); extra.className='cell'; extra.textContent='9'; s.appendChild(extra); // –¥–ª—è –±–µ—Å—à–æ–≤–Ω–æ—Å—Ç–∏
      d.appendChild(s); return d;
    }
    function build(){ odo.innerHTML=''; for(let i=0;i<DIGITS;i++) odo.appendChild(makeDigit(i)); }
    build();

    let cellH=0;
    function measure(){ const s=odo.querySelector('.cell'); if(s){ cellH=Math.round(s.getBoundingClientRect().height); } }
    measure(); addEventListener('resize',()=>{ measure(); setNumber(countThousands); });

    let prev=Array(DIGITS).fill(0);
    let countThousands=0;

    // –ø–µ—Ä–µ–≤–æ–¥ —Ü–∏—Ñ—Ä—ã –∫ –∏–Ω–¥–µ–∫—Å—É –≤ –ø–µ—Ä–µ–≤—ë—Ä–Ω—É—Ç–æ–π –∫–æ–ª–æ–Ω–∫–µ: 9..0 ‚Üí –∏–Ω–¥–µ–∫—Å = 9 - d
    function setNumber(nThousands){
      const nInt=Math.max(0,Math.floor(nThousands));
      const str=nInt.toString().padStart(DIGITS,'0');
      const strips=odo.querySelectorAll('.digit .strip');
      for(let i=0;i<DIGITS;i++){
        const d=+str[i];               // —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ü–∏—Ñ—Ä–∞
        const idx=9 - d;               // –ø–æ–∑–∏—Ü–∏—è –≤ –ø–µ—Ä–µ–≤—ë—Ä–Ω—É—Ç–æ–º —Å—Ç–æ–ª–±—Ü–µ
        const y=-cellH*idx;            // –¥–≤–∏–≥–∞–µ–º –í–í–ï–†–• —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ ‚Üí –≤–∏–∑—É–∞–ª—å–Ω–æ —Ü–∏—Ñ—Ä–∞ –∏–¥—ë—Ç –í–ù–ò–ó
        const st=strips[i];
        if(d!==prev[i]){
          st.parentElement.classList.add('anim');
          st.style.transform=`translate3d(0,${y}px,0)`;
        }
      }
      prev=str.split('').map(Number);
    }

    // –∞–∫–∫—É–º—É–ª–∏—Ä—É–µ–º –±—É—Ç—ã–ª–∫–∏ ‚Üí —Ç—ã—Å—è—á–∏
    let acc=0, last=performance.now();
    function loop(now){
      const dt=(now-last)/1000; last=now;
      acc += (BOTTLES_PER_SEC*dt)/1000; // –≤ —Ç—ã—Å—è—á–∞—Ö
      while(acc>=STEP_THOUSANDS){
        acc-=STEP_THOUSANDS; countThousands+=STEP_THOUSANDS; setNumber(countThousands);
      }
      requestAnimationFrame(loop);
    }
    requestAnimationFrame(loop);
  })();

  // FIX 2: –ü–ê–î–ê–Æ–©–ò–ï –ë–£–¢–´–õ–ö–ò ‚Äî —Å–Ω–æ–≤–∞ —Ä–∞–±–æ—Ç–∞—é—Ç –∏ –æ—Å—Ç–∞—é—Ç—Å—è –∑–∞ —Ç–µ–∫—Å—Ç–æ–º
  (function(){
    const section=document.getElementById('about'); if(!section) return;
    const canvas=document.getElementById('bottleCanvas'); const ctx=canvas.getContext('2d');
    let W=0,H=0,dpr=1,running=false,rafId=0; const pool=[];
    function resize(){
      const r=section.getBoundingClientRect();
      dpr=Math.min(window.devicePixelRatio||1,2);
      W=Math.max(320, Math.floor(r.width)); H=Math.max(280, Math.floor(r.height));
      canvas.width=W*dpr; canvas.height=H*dpr; canvas.style.width=W+'px'; canvas.style.height=H+'px';
      ctx.setTransform(dpr,0,0,dpr,0,0);
      canvas.style.zIndex='0'; section.style.position='relative';
    }
    resize(); addEventListener('resize', resize, {passive:true});

    function drawBottle(x,y,w,h,ang,alpha){
      ctx.save(); ctx.globalAlpha=alpha; ctx.translate(x,y); ctx.rotate(ang);
      // —Ç–µ–Ω—å
      ctx.fillStyle='rgba(0,0,0,0.06)'; ctx.beginPath();
      ctx.ellipse(0,h*0.52,w*0.45,w*0.18,0,0,Math.PI*2); ctx.fill();
      // –∫–æ—Ä–ø—É—Å
      const r=w*0.22; ctx.fillStyle='#3a86ff'; ctx.beginPath(); ctx.roundRect(-w/2,-h/2,w,h,r); ctx.fill();
      // –≥–æ—Ä–ª—ã—à–∫–æ
      ctx.fillStyle='#1e56c5'; ctx.beginPath(); ctx.roundRect(-w*0.18,-h*0.48,w*0.36,h*0.14,r*0.5); ctx.fill();
      // –∫—Ä—ã—à–∫–∞
      ctx.fillStyle='#0e3e9b'; ctx.fillRect(-w*0.18,-h*0.62,w*0.36,h*0.08);
      ctx.fillStyle='#1655cf'; ctx.fillRect(-w*0.16,-h*0.62,w*0.32,h*0.04);
      // –±–ª–∏–∫
      ctx.strokeStyle='rgba(255,255,255,0.5)'; ctx.lineWidth=2; ctx.beginPath();
      ctx.moveTo(-w*0.25,-h*0.25); ctx.quadraticCurveTo(-w*0.42,-h*0.05,-w*0.22,h*0.15); ctx.stroke();
      ctx.restore();
    }

    class Bottle{
      constructor(){
        const base=18+Math.random()*10;
        this.w=base; this.h=base*2.25;
        this.x=Math.random()*W; this.y=-this.h-20;
        this.vy=0.9+Math.random()*1.1;
        this.ax=(Math.random()*0.5-0.25)*0.15;
        this.ang=Math.random()*Math.PI; this.va=(Math.random()*0.6-0.3)*0.02;
        this.alpha=0; this.settled=false;
      }
      update(){
        if(this.settled) return;
        this.y += this.vy; this.x += this.ax; this.ang += this.va;
        this.alpha = Math.min(1, this.alpha + 0.05);
        if(this.y >= H - this.h*0.5){
          this.y = H - this.h*0.5;
          this.vy = 0; this.va *= 0.2; this.ax = 0; this.settled = true;
        }
      }
      draw(){ drawBottle(this.x,this.y,this.w,this.h,this.ang,this.alpha); }
    }

    function isFilled(){
      const target = Math.max(14, Math.floor((W*H) / (90*220)));
      let settled=0; for(const b of pool) if(b.settled) settled++;
      return settled >= target;
    }

    function tick(){
      ctx.clearRect(0,0,W,H);
      if(!isFilled() && pool.length<120 && Math.random()<0.5) pool.push(new Bottle());
      for(const b of pool){ b.update(); b.draw(); }
      if(running) rafId=requestAnimationFrame(tick);
    }

    const io=new IntersectionObserver(entries=>{
      entries.forEach(e=>{
        if(e.isIntersecting){ if(!running){ running=true; tick(); } }
        else { running=false; cancelAnimationFrame(rafId); }
      });
    },{threshold:0.25});
    io.observe(section);
  })();

  // FIX 3: –¢–æ—á–∫–∏ –Ω–∞ —Ç—Ä—É–±–µ ‚Äî –ø–æ–ø–∞–ø (–∫–∞–∫ –±—ã–ª–æ)
  (function(){
    const wrap=document.querySelector('.pipe-wrap'); if(!wrap) return;
    const info=document.getElementById('stageInfo');
    const title=document.getElementById('stageTitle');
    const text=document.getElementById('stageText');
    wrap.addEventListener('click',(e)=>{
      const dot=e.target.closest('.stage-dot');
      if(!dot){ info.hidden=true; return; }
      title.textContent = dot.dataset.title || '';
      text.textContent  = dot.dataset.text  || '';
      info.hidden=false;
      const x = dot.style.getPropertyValue('--x');
      const y = dot.style.getPropertyValue('--y');
      info.style.left = x; info.style.top = y;
      wrap.querySelectorAll('.stage-dot').forEach(d=>d.classList.remove('active'));
      dot.classList.add('active');
    });
  })();

  // FIX 4: REVEAL –¥–ª—è –±–ª–æ–∫–æ–≤
  (function(){
    const rev=document.querySelectorAll('.reveal');
    const io=new IntersectionObserver(es=>{
      es.forEach(e=>{ if(e.isIntersecting){ e.target.classList.add('visible'); io.unobserve(e.target); } });
    },{threshold:.25});
    rev.forEach(el=>io.observe(el));
  })();
  </script>
</body>
</html>
